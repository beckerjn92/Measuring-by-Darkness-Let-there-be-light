<!doctype html>
<!-- 
##############################################################
Ignore this boilerplate if you're just trying to edit the text.
Skip to the part that says 'The real text begins here'
##############################################################
Based on this theme: https://github.com/broccolini/dinky , which mentioned that attribution is appreciated. Thanks, broccolini!
-->

<!--<script async src="javascript/Minimal-MathJax/MathJax.js config=Tex-AMS-CHTML"></script>-->
<!--<script type="text/x-mathjax-config"> MathJax.Hub.Config({Tex:{equationNumbers:{autoNumber:"AMS"}},});</script>-->
<!--<script type="text/x-mathjax-config"> MathJax.Hub.Config({tex: {tags: 'ams'}});</script>-->

<html lang="en">
  <head>
    <base target="_blank">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="citation_title" content="Measuring by Darkness? Let there be light!">
    <meta name="citation_author" content="Rainer Heintzmann">
    <meta name="citation_author" content="Jan Becker">  
    <meta name="citation_publication_date" content="2019/01/28">
    <meta name="citation_journal_title" content="Github.io">
   <meta name="citation_pdf_url" content="http://beckerjn92.github.io/Measuring-by-Darkness-Let-there-be-light/Measuring_by_Darkness_Let_there_be_light.pdf">
    <title>Measuring by Darkness? Let there be light! by Rainer Heintzmann and Jan Becker</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/prism.css">
    <!--[if lt IE 9]>
    <script src="javascript/html5shiv/html5shiv.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
      <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
    <script src="javascript/scale_fix/scale.fix.js"></script>
    <script src="javascript/python-highlighting/prism.js"></script>
    <script async  src="javascript/Minimal-MathJax/MathJax.js?config=TeX-AMS_CHTML"></script>
    <script src="javascript/update_figures.js"></script>
    <script src="javascript/reference_list/reference_list.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
    TeX: { equationNumbers: { autoNumber: "all" } }
	});
	</script>
	
	<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
    });
	</script>
	
	
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h2 class="header">Measuring by Darkness? Let there be light!</h2>
        <ul>
          <li class="download"><a class="buttons" href="https://github.com/beckerjn92/Measuring-by-Darkness-Let-there-be-light/zipball/master">Download ZIP</a></li>
          <li><a class="buttons github" href="https://github.com/beckerjn92/Measuring-by-Darkness-Let-there-be-light">View On GitHub</a></li>
          <li><a class="buttons pdf" href="http://beckerjn92.github.io/Measuring-by-Darkness-Let-there-be-light/Measuring_by_Darkness_Let_there_be_light.pdf">Download PDF</a></li>
        </ul>
        <p class="header">This project is maintained by <a class="header name" href="https://github.com/beckerjn92">Jan Becker</a>.</p>
      </header>
<!-- 
##############################################################
The real text begins here.
##############################################################
 -->
<section>
<h1>Micro-publication</h1>
<h2>Measuring by Darkness? Let there be light!</h2>
<p class="author_list">Rainer Heintzmann<sup>1,2*</sup> and Jan Becker<sup>1</sup></p>
<p class="author_affiliations"><sup>1</sup>Leibniz Institute of Photonic Technology, Albert-Einstein-Str. 9, 07745 Jena, Germany</p>
<p class="author_affiliations"><sup>2</sup>Institute of Physical Chemistry and Abbe Center of Photonics, Friedrich-Schiller-University Jena, Helmholtzweg 4, 07743 Jena, Germany</p>
<p class="contact_email"><sup>*</sup>Email: <a href="mailto:heintzmann@gmail.com" target="_self">heintzmann@gmail.com</a></p>

<h3>Abstract</h3>
<p class="abstract">Building on work of York et al. [<a class="citation" href="https://doi.org/10.5281/zenodo.1463273" title="What is the signal-to-noise ratio of phase-contrast imaging? Can it be infinite?; Andrew G. York, Sanjay R. Varma; Pre-print.">York 2018</a>], we analyze a particular aspect of the following optics problem: Is the
signal to noise ratio (SNR) of interferometric nulling with a given photon budget infinite? We compare the previously
stated expression for the SNR with a different way of estimating an unknown amplitude: interfering with a very strong
reference wave of known strength, i.e. optical amplification. Our analysis reveals that optical amplification is in
all aspects superior to interferometric nulling. It not only yields more precise estimates, even when a scheme based
on rejecting an estimate is used, but in addition optical amplification does not require a rejection of a hypothesized
position estimate. We confirm our theoretical prediction with some numerical investigation; visually observing the
differences, as well as stating some statistical analysis.
</p>

<h4>Keywords:</h4>
<p id="keywords"> optical amplification, interference, signal-to-noise ratio (SNR), nulling.</p>

<h3>Peer review status</h3>
<p>Pre-print published Januray 28, 2020 (This article is not yet peer-reviewed)</p>
<p>Cite as: <a href="http://doi.org/10.5281/zenodo.3629784">doi:10.5281/zenodo.3629784</a></p>

<noscript>
<h3>Your browser doesn't seem to support Javascript. This document uses Javascript for interactive figures, math typesetting, and to automatically generate the reference list. Either activate Javascript, or use the "Download PDF" link above if you want properly typeset math and a reference list.</h3></noscript>

<h3>Introduction</h3>
<p>In the microâ€“publication [<a class="citation" href="https://zenodo.org/record/1463274" title="What is the signal-to-noise ratio of phase-contrast imaging? Can it be infinite?; Andrew G. York, Sanjay R. Varma; Pre-print">York</a>] describe an interesting scientific problem relating to measuring an amplitude-phase object using a Mach-Zehnder interferometer (Fig. 1). Their thought-experiment is based on the only source of noise being the stochastic nature of the photons:</p>
\begin{eqnarray}
Y_i & = & \mathcal{P} \{ y_i \}  \\
y_i & = & |a_i x + b_i|^2
\label{eqn:Intensity}
\end{eqnarray}

<p>with $Y_i$ being the measured number of photons in experiment number $i$, $\mathcal{P}$ describes the processes of drawing from a Poisson distribution with expected number of photons $y_i$, $x$ being the amplitude-phase object to measure $(|x|\leq 1$), $b_i$ being the reference amplitude in the interferometer and $a_i$ being the illumination amplitude before the object in this experiment.</p>

<figure id="Figure_1">
<img src="./images/Setup.png"
 alt="Figure 1" id="Figure_1_image" >
<figcaption><strong>Figure 1:</strong> Mach-Zehnder type interferometer as described by [<a class="citation" href="https://doi.org/10.5281/zenodo.1463273" title="What is the signal-to-noise ratio of phase-contrast imaging? Can it be infinite?; Andrew G. York, Sanjay R. Varma; Pre-print.">York 2018</a>]. One arm of the interferometer contains the unknown object &x$ + spatial light modulator (SLM) $a$. The reference arm only comprises a single SLM $b$. Both SLMs are able to perform a complex modulation of the light distribution, hence change amplitude and phase. In the constructive channel we obtain the signal $y = |ax + b|^2$. </figcaption>
</figure><p></p>

<p>The Poisson process $\mathcal{P} \{ y \}$ has the probability distribution:</p>
\begin{equation}
    P(Y|y) = \frac{y^Y}{Y!} \exp (-y) 
\label{eqn:Poisson}
\end{equation}

<p>The guessing "game" as described in [<a class="citation" href="https://doi.org/10.5281/zenodo.1463273" title="What is the signal-to-noise ratio of phase-contrast imaging? Can it be infinite?; Andrew G. York, Sanjay R. Varma; Pre-print.">York 2018</a>] is to estimate $x$ by a smart choice of $a_i$ and $b_i$  with the additional limitation of a finite illumination budget $A$, which is given as: $\sum_{i=1}^{N}{|a_i|^2} \leq A$ with $N$ being the number of experiments performed. York et al. continue to analyze this problem and arrive at the following expression for the signal-to-noise ratio (SNR):</p>
\begin{equation}
SNR =\frac{|a+b|^2}{|a x+b|} -| a x+b|
\label{eqn:SNR}
\end{equation}

<p>which has the surprising property of becoming infinite if the interferometer is adjusted for perfect configuration: $b=-ax$. This is the point which our micro-publication is addressing: Is the SNR of such an interferometric measurement for estimating $x$ really infinite?</p>

<h3>Nulling or amplification?</h3>
The first point to notice in eqn. $$\eqref{eqn:Intensity}$$ is that the result of each measurement is independent of the choice of a global phase, as the magnitude squared is calculated. Since both, $a_i$ and $b_i$, are permitted freely to choose their phase, a single relative phase suffices and we can set $a_i$ to always be real valued without loss of generality. Next we can separate the problem into a real and an imaginary part, which are added in quadrature. We therefore first analyze the real part of the problem by also assuming $x$ and $b_i$ to be real.
To gain some insight, we now further assume that all $N$ experiments refer to the same choice of $a_i$. Hence we can replace eqn. $$\eqref{eqn:Intensity}$$ with a single experiment using all the available photon budget at once:
\begin{equation}
y=|\sqrt{A} x + b|^2
\label{eqn:OneStep}
\end{equation}

<p>The infinite SNR in a nulling experiment as stated in eqn. $$\eqref{eqn:SNR}$$ does not consider that we may have estimated $x$ wrongly and thus chose a wrong value for $a$, but nevertheless obtained zero photons in our measurement due to the <em>limited</em> overall photon budget. </p>

<p>In our work, we aim to compare the estimation of $x$ by <em>nulling</em> (setting $b=-\sqrt{A} x$) with another scheme where $b\gg1$. This principle, termed <em>optical amplification</em>, is known for example in optical coherence tomography (OCT) as a method to eliminate read noise [<a class="citation" href="https://patents.google.com/patent/US6900943B2/en" title="Optical amplification in coherent optical frequency modulated continuous wave reflectometry; Peter E. Andersen, Anders Bjarklev, Andrea Tycho; US Patent 6900943B2">Andersen 2001</a>]. Here we do not analyze it in the context of read noise, rather as a general interferometric technique and compare it with the nulling scheme as suggested by York et al.</p>

<h3>Comparison of both approaches</h3>
<p>For a fair comparison it is essential to construct a thought experiment treating the schemes to compare equally.
This is not trivial: the nulling scheme (I) is a hypothesis test. It is able to achieve complete experimental agreement, i.e. for a chosen $b$ our measurement does not yield a single detected photon, hence our obtained estimate $\hat{x}$ is consistent with being the correct value $x$. The optical amplification scheme (II), however, typically detects a number of photons from which a value of $x$ is estimated with a predictable precision. These are two fundamentally different ways of how to infer information on $x$.</p>

<h4>A new thought experiment</h4>
<p>To nevertheless be able to compare both schemes on equal terms we designed the following hypothesis testing scheme: for a given (unknown) $x$ the range $x \in [-1,1]$ is tested in equal steps $S_x$ searching for $x = \hat{x}$. For the nulling scheme, consistency is given by detecting zero photons, whereas for the amplification scheme we have to define a different consistency rule: At each $x$ many such tests are performed and we evaluate and plot the frequency of consistent results.</p>

<p>In this case, being consistent means that the detected number of photons ($Y$) is within a small distance $\Delta y$ from the predicted number of photons (assuming $\hat{x} = x$), given the chosen value of $b$. To further simplify our analysis, we approximate $\Delta y$ to be small enough that there is no significant change of the probability of detecting photons over this range, i.e. the probability of detecting photons in the range $Y = y\pm\Delta y/2$ is approximately given by $\Delta y P(y|y)$. Since we further assumed $b$ to be large, we can approximate the Poisson distribution (eqn. $$\eqref{eqn:Poisson}$$) by a Gaussian probability density, with a variance equal to the expectancy:</p>
\begin{equation}
P(Y|y) = \frac{\exp{\left(\frac{-|Y-y|^2}{2y}\right)}}{\sqrt{2\pi y}}
\label{eqn:Gaussian}
\end{equation}

<h4>Comparing both inference schemes</h4>
<p>Now we are able to compare the quality to estimate $\hat{x}$ in our thought experiments. For the nulling scheme, we obtain the probability to measure zero photons according to eqn. $$\eqref{eqn:Poisson}$$ as:</p> 
\begin{eqnarray}
    y & = & |\sqrt{A} x - \sqrt{A} \hat{x}|^2 = A |x-\hat{x}|^2 \nonumber \\
    P(Y|y) & = & \frac{\left( A |x - \hat{x}|^2\right)^Y}{Y !} \exp(-A |x - \hat{x}|^2) \nonumber \\
    P(0|y) & = & \exp(-A |x-\hat{x}|^2)
\end{eqnarray}

<p>Introducing $b' = -\frac{b}{\sqrt{A}}$, this has to be compared to the result obtained in the amplification scheme. Noting that:</p>
\begin{equation}
        y = |\sqrt{A}x - \sqrt{A}b'|^2 = A |x - b'|
\end{equation}

<p>We can express eqn. $$\eqref{eqn:Gaussian}$$ as:</p>
\begin{eqnarray}
    P(Y|y) & = & \Delta y \frac{\exp(-\frac{|Y-y|^2}{2y})}{\sqrt{2\pi y}} \nonumber \\
    & = & \Delta y \frac{\exp(-\frac{|A |x-b'|^2-A |\hat{x}-b'|^2|^2}{2A |\hat{x}-b'|^2})}{\sqrt{2\pi A} |\hat{x}-b'|}
    \label{eq:approximation}
\end{eqnarray}
<p>With $Y = A |x-b'|^2$ the <em>actual</em> measured value and $y= A |\hat{x} - b'|^2$ our <em>estimated</em> measurement result. The exponent can be simplified as follows:</p>
\begin{eqnarray}
- \frac{A |x^2 - 2b'x - \hat{x}^2 + 2b'\hat{x}|^2}{2(\hat{x}^2 - 2b'\hat{x} + b'^2)} 
\approx  - \frac{A | - 2b'(x  - \hat{x})|^2}{2b'^2} = - 2 A |x - \hat{x}|^2
\end{eqnarray}

<p>Using the fact that $x << b'$ and $\hat{x} << b'$.</p>
<p>With this we can express eqn. $$\eqref{eq:approximation}$$ as:</p>
\begin{equation}
    P(Y | y) \approx \Delta y \frac{\exp \left(-2 A |x - \hat{x}|^2\right)}{\sqrt{2 \pi A} b'}
\end{equation}

<p>In both cases we obtain Gaussian probability distributions. However, if we now compare the two results, we notice a difference in their width. For the nulling scheme we obtain:</p>
\begin{equation}
    \sigma_\text{nulling} =  \frac{1}{\sqrt{2A}}
\end{equation}

<p>In case of the amplification scheme we get:</p>
\begin{equation}
    \sigma_\text{amplification}  =  \frac{1}{2\sqrt{A}} = \frac{\sigma_\text{nulling}}{\sqrt{2}} 
    \label{eq:relsigma}
\end{equation}

<p>Leading to the interesting result that the estimation based on the amplification scheme seems to be more precise than the estimation based on interferometric nulling.</p>

<h4>Estimating from each individual measurement</h4>
<p>However, this leaves us with the problem that the overall success rate of our amplification hypothesis test is fairly low, since $\Delta y$ has to be chosen much smaller than the width of the probability distribution to render our approximation in eqn. $$\eqref{eq:approximation}$$ valid. 
Yet, if we chose a different estimation scheme, using a large reference $b$, but estimating $\hat{x}$ directly from each measurement as:</p>
\begin{eqnarray}
y & = & A|x-b'|^2 \nonumber \\
\rightarrow \hat{x} & = & b'-\sqrt{y/A}
\end{eqnarray}

<p>for large positive $b'$. This yields a probability distribution equal to the hypothesis testing scheme (eqn. $$\eqref{eq:approximation}$$), with the only difference that in each case a solution is found leading to an estimate and there is no experiment which gets rejected by the hypothesis test. This is in all respects superior compared to the hypothesis testing scheme using interferometric nulling. Not only is an estimation possible every single time, but even for the cases where the experimental outcome is not rejected, its estimate is on average closer to the true value $x$.</p>

<h3>Numerical results</h3>
<p>To verify our theoretical findings, we did some numerical evaluation of both inferring schemes.</p>
<h4>General description of our numerical evaluation</h4>
<p>In total we performed three different experiments: for three different photon budgets (10, 40 and 100) we inferred the unknown $x$ using both strategies.
For each photon budget, we inferred 10 different values of $x$, which have been chosen randomly within the unit circle, by having amplitude and phase being uniformly distributed. For each $x$ we run the respective inferring scheme 10 times to get some statistical significant. Note that we have implemented the algorithm in an iterative way ($a_i=1$), in contrast to our derivation in section sec. 2. In each iteration the algorithm calculates a probability map, indicating the likelihood of the true $x$ being found at that specific position. For the nulling approach the value of $b$ has been chosen according to $b=-\sqrt{A} \hat{x}$, with $\hat{x}$ being the current (best) estimate. In case of the amplification scheme, $b$ has been chosen according to $|b|>>1$. The phase of $b$ changes in steps of $\pi/2$ for each iteration, so that there is always an alternating between the real and the imaginary axis . For more detail have a look in the code we provide with this publication (see supplement).</p>

<h4>Graphical comparison between both strategies</h4>
<p>In Figure 2 we show the results of both algorithms for five different iteration steps. the parameters used were: $A = 40$; $a = 1$; $|b| = \sqrt{10}$. A red cross indicates the true position of $x$ and the yellow ring the current estimate $\hat{x}$ . The blue background indicates the probability map, telling us the likelihood of the true $x$ to be found here. A higher probability is indicted by a darker color. Both algorithms start with the same probability distribution (blue); a constant as there is no information yet leaving all possible $x$ with the same change of being the true value. From there on we describe both algorithms separately.</p>

<figure id="Figure_2">
<img src="./images/AlgorithmVisualisation2.png"
 alt="Figure 2" id="Figure_2_image" >
<figcaption><strong>Figure 2:</strong> Graphical comparison of both inferring schemes; <em>nulling</em> (top) and <em>amplification</em> (bottom) for 5 different inferring steps. Each graph shows the true value $x$ (red), the current estimation $\hat{x}$ (yellow) and the corresponding probability map (blue; darker = higher probability). The following parameters were used: $A = 40$; $a = 1$; $|b| = \sqrt{10}$. See also Video 1 & Video 2 for a more traceable visualization. </figcaption>
</figure><p></p>

<u>Nulling: </u>
<p>Already in the beginning of the iterations a photon is measured; hence indicating that the current estimate can not be the correct one. As the intention of the nulling scheme is to achieve perfect interferometric canceling, overall there wont be many photons being measured. Hence an update of the probability map happens rarely (also see video <em>Interference-Inference-nulling.avi </em>} in the supplement). When a photon is measured the probability map changes (Fig. 2, top), as we must include a zero probability at the position of our current estimate $\hat{x}$. The more photons are measured the more irregularly shaped the respective probability distribution gets. The final guess ended up close to the correct value of $x$. We show the residuals throughout the iteration in Fig. 3.</p>

<u>Amplification: </u>
<p>The main difference to the nulling approach is that in each iteration, we always obtain a new estimate $\hat{x}$. Therefore also the probability map changes in every iteration, but stays in an ellipsoidal shape. Following the maximum of the distribution reveals some <em>wiggly</emd>-motion (see video <em>Interference-Inference-amplification.avi</em> in the supplement. It is possible that a new estimate actually is worse than the previous one, which comes from the randomness of the measurement process. Nevertheless, on average, we end up much closer to the true value $x$, when all illumination photons have been used, as indicated in Fig. 3 and Tab. 1.</p>

<strong> Animation: </strong> Example inference of an unkown object (red) with: <u>nulling</u> (left) and <u>amplification</u> (right) scheme. The probability distribution for each iteration is shown in blue.
<table class="tg">
<div class="row>
	<div class="column">
		<img src="./videos/Nulling_new.gif" alt="nulling_vid" width="48%" align="left"/> 
	</div>
	<div class="column">
		<img src="./videos/Amplification_new.gif" alt="amplification_vid" width="48%" align="right"/>
	</div>
</div>
</table><p></p>

<h4>Statistical analysis of our numerical results</h4>
<p>For each experiment we have calculated the residuals: $\varepsilon = x - \hat{x}$. To analyze the statistical behavior we show the mean ($\bar{\varepsilon}$) and the standard deviation of the mean ($\sigma_{\bar{\varepsilon}}$), for each iteration by taking the $10 \cdot 10$ numerical experiments into account. The result is presented  in Fig. 3 a), where we show $|\varepsilon|$. In the first half of the inferring game, on average, the nulling scheme outperforms our amplification approach. However, towards higher iteration number we observe a clear enhancement inferring using $b>>1$ (see small inlet). Also note that the uncertainty in latter is much reduced (also see Tab.1). In Fig. 3 b & c) we show the standard deviation of the probability map along real and imaginary axis, for each iteration.</p> 

<figure id="Figure_3">
<img src="./images/Comparison.png"
 alt="Figure 3" id="Figure_3_image" >
<figcaption><strong>Figure 3:</strong> Comparing the performance of the nulling (blue) and amplification (magenta) scheme for each iteration. We show the mean residual ($\bar{\varepsilon}$; line) $\pm$ one std. dev. deviation of the mean ($\sigma_{\bar{\varepsilon}}$), which we obtained by evaluating the inferring of 10 randomly chosen (amplitude & phase both uniformly distributed), each with 10 different tries. a) shows $|\varepsilon|$. b) & c) indicate the evolution of the probability map's variance along the real and imaginary axis. The small inlets show a zoomed region of each plot. The following parameters were used: $A = 100$; $a = 1$; $|b| = \sqrt{10}$. </figcaption>
</figure><p></p>

<p>Throughout the whole inferring process, the amplification algorithm results in a much smaller probability distribution, hence a more accurate estimation of $x$. This becomes also clear when looking at Fig. 2; overall the amplification algorithm tries to find a solution in the direct neighboorhood, while in the nulling scheme an updated estimate $\hat{x}$ might lie opposite to the previous choice.</p>

<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;margin:0px auto;}
.tg td{font-family:Arial, sans-serif;font-size:12px;padding:8px 4px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:12px;font-weight:normal;padding:8px 4px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-baqh{text-align:center;vertical-align:top}
.tg .tg-nrix{text-align:center;vertical-align:middle}
</style>
<table class="tg">
  <tr>
    <td class="tg-nrix">Photon budget \(A\)</td>
    <td class="tg-nrix"></td>
    <td class="tg-nrix">Nulling</td>
    <td class="tg-nrix">Amplification</td>
    <td class="tg-nrix">Nulling / Amplification</td>
  </tr>
  <tr>
    <td class="tg-nrix" rowspan="4">10</td>
    <td class="tg-nrix">\(\bar{\varepsilon}\)</td>
    <td class="tg-nrix">0.3048</td>
    <td class="tg-nrix">0.2767</td>
    <td class="tg-nrix">1.1017</td>
  </tr>
  <tr>
    <td class="tg-nrix">\(\sigma_{\bar{\varepsilon}}\)</td>
    <td class="tg-nrix">0.0226</td>
    <td class="tg-nrix">0.0156</td>
    <td class="tg-nrix">1.4455</td>
  </tr>
  <tr>
    <td class="tg-baqh">\(\bar{\sigma_r}\)</td>
    <td class="tg-baqh">0.2400</td>
    <td class="tg-baqh">0.1916</td>
    <td class="tg-baqh">1.2526</td>
  </tr>
  <tr>
    <td class="tg-baqh">\(\bar{\sigma_i}\)</td>
    <td class="tg-baqh">0.2532</td>
    <td class="tg-baqh">0.2081</td>
    <td class="tg-baqh">1.1066</td>
  </tr>
  <tr>
    <td class="tg-nrix" rowspan="4">40</td>
    <td class="tg-baqh">\(\bar{\varepsilon}\)</td>
    <td class="tg-baqh">0.1455</td>
    <td class="tg-baqh">0.1315</td>
    <td class="tg-baqh">1.1066</td>
  </tr>
  <tr>
    <td class="tg-baqh">\(\sigma_{\bar{\varepsilon}}\)</td>
    <td class="tg-baqh">0.0114</td>
    <td class="tg-baqh">0.0066</td>
    <td class="tg-baqh">1.7428</td>
  </tr>
  <tr>
    <td class="tg-baqh">\(\bar{\sigma_r}\)</td>
    <td class="tg-baqh">0.1264</td>
    <td class="tg-baqh">0.1003</td>
    <td class="tg-baqh">1.2605</td>
  </tr>
  <tr>
    <td class="tg-baqh">\(\bar{\sigma_i}\)</td>
    <td class="tg-baqh">0.1329</td>
    <td class="tg-baqh">0.1088</td>
    <td class="tg-baqh">1.2213</td>
  </tr>
  <tr>
    <td class="tg-nrix" rowspan="4">100</td>
    <td class="tg-baqh">\(\bar{\varepsilon}\)</td>
    <td class="tg-baqh">0.1051</td>
    <td class="tg-baqh">0.0861</td>
    <td class="tg-baqh">1.2204</td>
  </tr>
  <tr>
    <td class="tg-baqh">\(\sigma_{\bar{\varepsilon}}\)</td>
    <td class="tg-baqh">0.0076</td>
    <td class="tg-baqh">0.0044</td>
    <td class="tg-baqh">1.7300</td>
  </tr>
  <tr>
    <td class="tg-baqh">\(\bar{\sigma_r}\)</td>
    <td class="tg-baqh">0.0839</td>
    <td class="tg-baqh">0.0659</td>
    <td class="tg-baqh">1.2740</td>
  </tr>
  <tr>
    <td class="tg-baqh">\(\bar{\sigma_i}\)</td>
    <td class="tg-baqh">0.0872</td>
    <td class="tg-baqh">0.0711</td>
    <td class="tg-baqh">1.2266</td>
  </tr>
  <tabcaption><strong>Table 1:</strong> Mean (\(\bar{\varepsilon}\)) and the standard deviation of the mean (\(\sigma_{\bar{\varepsilon}}\)) of the residuals at the last iteration. Also the standard deviation of the probability distribution along the real (\(\bar{\sigma_r}\)) and the imaginary (\(\bar{\sigma_i}\)) axis is shown. All quantities are given for three different photon budgets (\(A\)). The amplification strategy beats the nulling scheme, as seen from the ratio \(>1\) in the last column. </tabcaption>
</table><p></p>

<p>As expected, all quantities decrease when a higher photon budget is available as it is possible to obtain more information about the sample. When comparing both inferring schemes, we note that in all scenarios the amplification strategy gives better results, as predicted in our theoretical section.
Note that this is not only true for a low photon budget. Even with higher illumination, the amplification strategy shows better results than the nulling approach.</p>

<h3>Discussion</h3>
<p>Our numerical results show that indeed the optical amplification algorithm gives better estimates than the previously suggested nulling scheme. We not only observe better estimations of $x$, also our prediction accuracy is higher. The probability distributions, generated in each iteration of both algorithms, are always more narrow in the amplification scheme (see Fig. 3 b & c). However, we observe a difference in the width along the real and imaginary axis.</p> 

<p>It turns out, that our predicted factor of improvement ($\sqrt{2} \approx 1.4142$; eq. $$\eqref{eq:relsigma}$$) is not completely reached in our numerical results  (see Tab. 1). An explanation for this might, that our choice of $|b| = \sqrt{10}$ only partially resembles the assumption in our theoretical derivation ($b >> 1$). </p>

<p>Nevertheless, we have clearly shown that a <em>better</em> algorithm than the nulling scheme, suggested in [<a class="citation" href="https://doi.org/10.5281/zenodo.1463273" title="What is the signal-to-noise ratio of phase-contrast imaging? Can it be infinite?; Andrew G. York, Sanjay R. Varma; Pre-print.">York 2018</a>], can be found. It may be argued that a smarter algorithm than subsequent testing of possible candidates $\hat{x}$ might also achieve an estimate for $x$ in every single case. However, this modified nulling procedure will never be able to beat the hypothesis testing scheme in precision for the cases where no photons were detected. In such cases the nulling scheme is always "stuck" by assuming that its current estimate is already the correct solution, yet it is still on average further away from the true $x$ than what can be achieved by the amplification scheme III, because: $\sigma_\text{nulling} > \sigma_\text{amplification}$.</p>

<p>However, there is an important aspect, which we did not analyze due to the initial assumption of a real-valued $b$: in the nulling scheme, the hypothesis ($x=\hat{x}$) is confirmed simultaneously for both the real and the imaginary part of the equation. Whereas the amplification scheme only yields information about the real part in both, the hypothesis--testing and the continuous--estimation approaches. A simple way to accommodate for this disadvantage would be to alternate $b$ between large real and large imaginary values similar to the suggestion in [<a class="citation" href="https://doi.org/10.5281/zenodo.1463273" title="What is the signal-to-noise ratio of phase-contrast imaging? Can it be infinite?; Andrew G. York, Sanjay R. Varma; Pre-print.">York 2018</a>]. This would half the photon budget along each direction, yielding a worsening of the estimate by $\sqrt{2}$, which would then modify eqn. $$\eqref{eq:relsigma}$$ into $\sigma_\text{amplification}  = \sigma_\text{nulling}$. Nevertheless we argue that the amplification scheme is still superior, since it is not a hypothesis testing scheme but yields a new estimate in every test.</p>

<h3>Conclusion</h3>
<p>We have shown that the SNR for interferometric compensation (nulling) for the practical case of estimating $x$ is, in contrast to the analysis of York et al. [<a class="citation" href="https://doi.org/10.5281/zenodo.1463273" title="What is the signal-to-noise ratio of phase-contrast imaging? Can it be infinite?; Andrew G. York, Sanjay R. Varma; Pre-print.">York 2018</a>], not infinite. Furthermore there is also a significantly better scheme for estimating $x$, which is simply choosing a very large (ideally infinite) value of $b$ (or $b'$). The numerical evaluation we have done is in good agreement with our theoretical finding and might lead to an even better inference algorithm in the future.
%This result has implications, suggesting a possible algorithm could be based on dividing the available photon budget into $N$ fractions and choosing large values of $b_n = B \exp(i 2n\pi/N)$ with a large real value of $B$. 
In a further micro-publication we extend these thoughts and analyze the full problem of estimating the complex value "$\hat{x}$" theoretically and by simulations.</p>

<h4>Supplementary material:</h4>
<p>With this publication we also publish the following two Python scripts:</p>


<ul>
	<li> <u>Interference-Inference-graphics.py:</u> The script shows the inferring process for a single experiment (single photon budget). Besides a visualization of the unit circle, the estimated $x$-values and the probability map, there is also an updating graph showing some of the statistical quantities changing in each iteration. </li>
	<li> <u>Interference-Inference-statistics.py:</u> This script performs several experiments (for a given photon budget) and evaluates some statistical quantities, shown in Tab. 1. The only output in the end is given in the editor, no graphical visualization or other user information. </li>
</ul>

<p>Additionally we also provide two videos visualizing the inferring process for both strategies which are named:
<em>Interference-Inference-nulling.avi</em> and <em>Interference-Inference-amplification.avi</em> </p>

<h4>Acknowledgment:</h4>
<p>We would like to thanks Andrew York for posing and advertising this interesting problem and his enthusiastic talks about this topic on conferences.</p> 

<h4>Competing financial interests:</h4>
<p>The authors declare no competing financial interests.</p>

<noscript>
<h3>Your browser doesn't seem to support Javascript. This document uses Javascript to generate a reference list, which would normally be displayed here. Either activate Javascript, or use the "Download PDF" link above if you want to see the reference list.</h3></noscript>

</section>
<footer>
  <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>

  <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a></small></p>
</footer>
</div>
 <!--[if !IE]><script>fixScale(document);</script><![endif]-->
</body>
</html>
